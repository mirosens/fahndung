From d2082d3506c43073c37368a263348045792aab0c Mon Sep 17 00:00:00 2001
From: OpenAI <openai@example.com>
Date: Fri, 8 Aug 2025 10:29:53 -0700
Subject: [PATCH] feat(a11y): add skip link and dynamic main container; unify
 logging in OptimizedLayout; enable Tailwind base and components

---
 src/app/globals.css                       |  8 +++++++-
 src/app/layout.tsx                        | 15 ++++++++++++++-
 src/components/layout/OptimizedLayout.tsx | 17 ++++++++++-------
 3 files changed, 31 insertions(+), 9 deletions(-)

diff --git a/src/app/globals.css b/src/app/globals.css
index 22e5120..7051c85 100644
--- a/src/app/globals.css
+++ b/src/app/globals.css
@@ -1,4 +1,10 @@
-@import "tailwindcss/preflight";
+/*
+ * Tailwind CSS core directives. `@tailwind base` injects a reset and base
+ * styles, `@tailwind components` adds component classes and `@tailwind utilities`
+ * includes low-level utility classes such as `sr-only` and `focus` styles.
+ */
+@tailwind base;
+@tailwind components;
 @tailwind utilities;
 
 /* Firefox-spezifische Verbesserungen für Touch-Interaktionen */
diff --git a/src/app/layout.tsx b/src/app/layout.tsx
index 76be6c3..9364aee 100644
--- a/src/app/layout.tsx
+++ b/src/app/layout.tsx
@@ -23,6 +23,15 @@ export default function RootLayout({
   return (
     <html lang="de" suppressHydrationWarning>
       <body className="antialiased" suppressHydrationWarning>
+        {/* Skip-Link for better accessibility. When focused (via Tab key), this becomes visible
+         and allows users using screen readers or keyboard navigation to jump directly
+         to the main content area. */}
+        <a
+          href="#mainContent"
+          className="sr-only focus:not-sr-only absolute top-0 left-0 z-50 m-2 rounded bg-primary px-4 py-2 text-sm font-medium text-background focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-offset-background"
+        >
+          Zum Hauptinhalt springen
+        </a>
         <TRPCReactProvider>
           <ThemeProvider
             attribute="class"
@@ -33,9 +42,13 @@ export default function RootLayout({
             <SessionManager />
             <RealtimeSyncWrapper>
               <OptimizedLayout>
+                {/* Performance and DevTools components remain outside main region */}
                 <PerformanceMonitor />
                 <DevToolsSuppressor />
-                {children}
+                {/* Main content of every page; the skip link targets this element */}
+                <main id="mainContent" className="min-h-screen">
+                  {children}
+                </main>
               </OptimizedLayout>
             </RealtimeSyncWrapper>
           </ThemeProvider>
diff --git a/src/components/layout/OptimizedLayout.tsx b/src/components/layout/OptimizedLayout.tsx
index 6377750..ecfcf84 100644
--- a/src/components/layout/OptimizedLayout.tsx
+++ b/src/components/layout/OptimizedLayout.tsx
@@ -1,6 +1,9 @@
 "use client";
 
 import { useEffect } from "react";
+// Import the shared warn function. In production builds this will no-op,
+// preventing console noise.
+import { warn } from "~/lib/logger";
 import { usePathname } from "next/navigation";
 import { useNavigationOptimizer } from "~/hooks/useNavigationOptimizer";
 import { api } from "~/trpc/react";
@@ -25,12 +28,12 @@ export function OptimizedLayout({ children }: { children: React.ReactNode }) {
         // Auf Homepage: Prefetch Dashboard und Fahndungen
         utils.post.getInvestigations
           .prefetch({ limit: 20, offset: 0 })
-          .catch(console.error);
+          .catch((error) => warn(error));
       } else if (pathname === "/fahndungen") {
         // Auf Fahndungen-Seite: Prefetch Detailseiten für erste Ergebnisse
         utils.post.getInvestigations
           .prefetch({ limit: 10, offset: 0 })
-          .catch(console.error);
+          .catch((error) => warn(error));
       } else if (
         pathname.startsWith("/fahndungen/") &&
         !pathname.includes("/neu")
@@ -38,16 +41,16 @@ export function OptimizedLayout({ children }: { children: React.ReactNode }) {
         // Auf Detailseite: Prefetch verwandte Fahndungen
         utils.post.getInvestigations
           .prefetch({ limit: 5, offset: 0 })
-          .catch(console.error);
+          .catch((error) => warn(error));
       } else if (pathname === "/dashboard") {
         // Auf Dashboard: Prefetch Benutzer-spezifische Daten
         utils.post.getMyInvestigations
           .prefetch({ limit: 10, offset: 0 })
-          .catch(console.error);
+          .catch((error) => warn(error));
       }
     } catch (error) {
       // Fehler beim Prefetching sind nicht kritisch - nur loggen
-      console.warn("⚠️ Prefetch-Fehler (nicht kritisch):", error);
+      warn("⚠️ Prefetch-Fehler (nicht kritisch):", error);
     }
   }, [pathname, prefetchCommonRoutes, utils]);
 
@@ -66,7 +69,7 @@ export function OptimizedLayout({ children }: { children: React.ReactNode }) {
               .prefetch({ id: investigationId })
               .catch((error) => {
                 // Nur warnen, nicht als kritischen Fehler behandeln
-                console.warn(
+                warn(
                   "⚠️ Investigation Prefetch-Fehler (nicht kritisch):",
                   error,
                 );
@@ -76,7 +79,7 @@ export function OptimizedLayout({ children }: { children: React.ReactNode }) {
       }
     } catch (error) {
       // Fehler beim Prefetching sind nicht kritisch - nur loggen
-      console.warn("⚠️ Investigation Prefetch-Fehler (nicht kritisch):", error);
+      warn("⚠️ Investigation Prefetch-Fehler (nicht kritisch):", error);
     }
   }, [pathname, utils]);
 
-- 
2.39.5

