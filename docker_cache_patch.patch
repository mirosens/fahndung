From c34473bff6e4b727a6ba6a786f46f175590ff1b1 Mon Sep 17 00:00:00 2001
From: OpenAI <openai@example.com>
Date: Fri, 8 Aug 2025 10:30:33 -0700
Subject: [PATCH] feat(docker): use BuildKit cache for pnpm installs to speed
 up builds

---
 docker/Dockerfile | 7 +++++--
 1 file changed, 5 insertions(+), 2 deletions(-)

diff --git a/docker/Dockerfile b/docker/Dockerfile
index 952cf35..4413207 100644
--- a/docker/Dockerfile
+++ b/docker/Dockerfile
@@ -11,7 +11,8 @@ RUN corepack enable && corepack prepare pnpm@8.15.3 --activate
 COPY . .
 
 # Install dependencies
-RUN pnpm install --frozen-lockfile
+RUN --mount=type=cache,target=/root/.local/share/pnpm \
+    pnpm install --frozen-lockfile
 
 # Build the Next.js application
 ENV NODE_ENV=production
@@ -27,7 +28,9 @@ COPY --from=builder /app/package.json ./
 COPY --from=builder /app/pnpm-lock.yaml ./
 
 # Only install production dependencies
-RUN corepack enable && corepack prepare pnpm@8.15.3 --activate && pnpm install --prod --frozen-lockfile
+RUN --mount=type=cache,target=/root/.local/share/pnpm \
+    corepack enable && corepack prepare pnpm@8.15.3 --activate && \
+    pnpm install --prod --frozen-lockfile
 
 # Copy the built application
 COPY --from=builder /app/.next ./.next
-- 
2.39.5

